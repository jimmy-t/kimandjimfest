<!DOCTYPE html>
<html>
    <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta property="og:url" content="http://kimandjimfest.com/sko" />
    <meta property="og:title" content="KimAndJimFest.com" />
    <meta property="og:description" content="(sko!)" />
    <meta property="og:image" content="http://nelsonfest.com/hahaguy.jpg" />
    <style>
    canvas {
        border:1px solid #d3d3d3;
        background-color: #00AA00;
        width: 100%;
        height: auto;
    }
    </style>
 <title>Sko!</title>
 </head>
 <body>
 
 <canvas id='canvas'></canvas><br />
 <button onclick='moveLeft()'>Left</button>
 <button onclick='moveRight()'>Right</button>
 <button onclick='moveUp()'>Up</button>
 <button onclick='moveDown()'>Down</button>

 <script>
    var canvasWidth = 300; 
    var canvasHeight = 100;

    var spriteWidth = 180;
    var spriteHeight = 54;

    var rows = 2; 
    var cols = 6; 

    var trackRight = 0; 
    var trackLeft = 1; 

    var width = spriteWidth/cols; 
    var height = spriteHeight/rows; 

    var curFrame = 0; 
    var frameCount = 6; 

    var x=0;
    var y=100; 

    var srcX = curFrame * width; 
    var srcY = 0; 

    var dirX = "none";
    var dirY = "none";

    var speedX = 1; 
    var speedY = 1; 

    var canvas = document.getElementById('canvas');
    canvas.width = canvasWidth;
    canvas.height = canvasHeight; 

    var ctx = canvas.getContext("2d");

    var character = new Image(); 
    character.src = "8-bit-lil-sebastian-sprite-with-pause.png";
    //character.src = "8-bit-horse-sprite-with-pause.png";

    var framesPerMove = 6;
    var moveCountdown = 0;

    //ctx.scale(0.5, 0.5);
    ctx.drawImage(character,srcX,srcY,width,height,x,y,width,height);

    function updateFrame(){
        curFrame = ++curFrame % frameCount;
        moveCountdown = ++moveCountdown % framesPerMove;
        var allowMove = curFrame != 1 && curFrame != 2 && curFrame != 4 && curFrame != 5;
        allowMove &= moveCountdown == 0;
        srcX = curFrame * width; 
        ctx.clearRect(x,y,width,height); 

        if (dirX == "left"){
            if (x > 0) {
                srcY = trackLeft * height; 
                if (allowMove) x -= speedX; 
            } else {
                dirX = "right";
            }
        }

        if (dirX == "right"){
            if (x < canvasWidth - width) {
                srcY = trackRight * height; 
                if (allowMove) x += speedX; 
            } else {
                dirX = "left";
            }
        }

        if (dirY == "up" && y > 0){
            if (allowMove) y -= speedY; 
        }

        if (dirY == "down" && y < canvasHeight - height){
            if (allowMove) y += speedY; 
        }
    }

    function draw(){
        updateFrame();
        ctx.drawImage(character,srcX,srcY,width,height,x,y,width,height);
    }

    function moveLeft(){
        dirX = "left";
    }

    function moveRight(){
        dirX = "right";
    }

    function moveUp(){
        dirY = "up";
    }

    function moveDown(){
        dirY = "down";
    }

    setInterval(draw,100);

 </script>
 </body>
</html>
